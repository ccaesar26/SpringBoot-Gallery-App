<!DOCTYPE html>
<html lang="en" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layout.html}">
<head>
    <title>Home</title>
    <style>
        /* Set a fixed size for the album cards */
        .album-card {
            width: 250px; /* Fixed width */
            height: 332px; /* Fixed height */
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            background-color: #1f2937; /* Dark background for the card */
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 16px;
        }

        /* Ensure the cover images are square and fit within the card */
        .album-cover {
            width: 218px;
            height: 218px; /* Fixed height for the cover image */
            object-fit: cover; /* Ensure the image covers the area without distortion */
            border-radius: 8px;
            margin-top: 26px;
        }

        /* Grid container for the cards */
        .album-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); /* Responsive grid */
            gap: 16px; /* Space between cards */
            justify-items: center; /* Align the cards in the center */
        }

        /* Styling for the create new album card */
        .create-album-card {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: #1f2937;
            width: 250px;
            height: 332px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .create-album-card:hover {
            background-color: #374151;
        }

        .create-album-icon {
            width: 40px;
            height: 40px;
            background-color: #4f46e5;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 50%;
        }

        .create-album-text {
            margin-top: 12px;
            color: #ccc;
            font-size: 14px;
        }
    </style>
</head>
<body>
<div layout:fragment="content">
    <div class="container mx-auto p-4 space-y-8">
        <!-- Search Bar -->
        <div class="flex justify-between items-center bg-gray-800 p-4 rounded-lg shadow-md">
            <form th:action="@{/home/search}" method="get" class="flex w-full">
                <input type="text" name="query" placeholder="Search albums..."
                       class="w-full p-2 bg-gray-700 text-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-indigo-500"
                       th:value="${query}"/>
                <button type="submit"
                        class="ml-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700">
                    Search
                </button>
            </form>
        </div>


        <!-- My Albums Section -->
        <div>
            <h2 class="text-xl font-semibold mb-4">My Albums</h2>

            <div class="album-grid">
                <!-- Check if myAlbums is empty -->
                <div th:if="${not #lists.isEmpty(myAlbums)}">
                    <div th:each="album : ${myAlbums}">
                        <a th:href="@{/album/{id}(id=${album.id})}" class="album-card">
                            <div class="h-48 bg-gray-600 flex items-center justify-center rounded-lg">
                                <div th:if="${album.photos.size() > 0}">
                                    <img th:src="@{'/images/' + ${album.photos[0].id}}" alt="Album Cover"
                                         class="album-cover">
                                </div>
                                <div th:if="${album.photos == null or album.photos.size() == 0}"
                                     class="text-white text-center">
                                    No Cover Image
                                </div>
                            </div>
                            <div class="mt-2">
                                <h3 class="text-lg font-semibold" th:text="${album.title}"></h3>
                                <p class="text-sm text-gray-400" th:text="'Created: ' + ${album.createdAt}"></p>
                                <p class="text-sm text-gray-400" th:text="'Owner: ' + ${owner.username}"></p>
                            </div>
                        </a>
                    </div>
                </div>

                <!-- Create New Album Tile -->
                <div>
                    <a href="/create-album" class="create-album-card">
                        <div class="create-album-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-gray-300" fill="none"
                                 viewBox="0 0 24 24"
                                 stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                      d="M12 4v16m8-8H4"></path>
                            </svg>
                        </div>
                        <span class="create-album-text">Create New</span>
                    </a>
                </div>
            </div>
        </div>

        <!-- Other Albums Section -->
        <div>
            <h2 class="text-xl font-semibold mb-4">Other Albums</h2>
            <div class="album-grid">
                <div th:each="album : ${otherAlbums}">
                    <!-- Check if the album is accessible -->
                    <div th:if="${album.canAccess}">
                        <a th:href="@{/album/{id}(id=${album.album.id})}" class="album-card">
                            <div class="h-48 bg-gray-600 flex items-center justify-center rounded-lg">
                                <div th:if="${album.album.photos.size() > 0}">
                                    <img th:src="@{'/images/' + ${album.album.photos[0].id}}" alt="Album Cover"
                                         class="album-cover">
                                </div>
                                <div th:if="${album.album.photos == null or album.album.photos.size() == 0}"
                                     class="text-white text-center">
                                    No Cover Image
                                </div>
                            </div>
                            <div class="mt-2">
                                <h3 class="text-lg font-semibold" th:text="${album.album.title}"></h3>
                                <p class="text-sm text-gray-400" th:text="'Created: ' + ${album.album.createdAt}"></p>
                                <p class="text-sm text-gray-400" th:text="'Owner: ' + ${album.username}"></p>
                            </div>
                        </a>
                    </div>

                    <!-- Display a non-clickable album card with a lock icon -->
                    <div th:unless="${album.canAccess}">
                        <div class="album-card" style="cursor: not-allowed;">
                            <div class="h-48 bg-gray-600 flex items-center justify-center rounded-lg">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-gray-300" fill="none"
                                     viewBox="0 0 24 24"
                                     stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                          d="M12 14l9-5-9-5-9 5 9 5z"></path>
                                </svg>
                            </div>
                            <div class="mt-2">
                                <h3 class="text-lg font-semibold" th:text="${album.album.title}"></h3>
                                <p class="text-sm text-gray-400">Locked</p>
                                <p class="text-sm text-gray-400" th:text="'Owner: ' + ${album.username}"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>
